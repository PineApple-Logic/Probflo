   // Define the data mapping for options
   const optionData = [
    "{Zero: 0.85, Low: 0.1, Med: 0.04, High: 0.01}",
    "{Zero: 0.25, Low: 0.6, Med: 0.1, High: 0.05}",
    "{Zero: 0.05, Low: 0.1, Med: 0.6, High: 0.25}",
    "{Zero: 0.01, Low: 0.04, Med: 0.1, High: 0.85}"
   ];

const form = document.getElementById('assessment-form');

form.addEventListener('submit', function (event) {
    event.preventDefault();

    // Select all the select elements in the form
    const selectElements = form.querySelectorAll('select');

  
    const selectedDataValues = [];
    let nodenames = "", nodevalues = ""
    // Iterate through the select elements
    selectElements.forEach(function (select) {
        // Get the selected option value
        const selectedOption = select.value;
        const selectedOptionNumber  = select.selectedIndex;
        nodenames += select.parentNode.parentNode.children[0].innerText+","
        nodevalues += JSON.stringify(optionData[selectedOptionNumber])+"||"
        // Map the selected option to its data-value
      
    });


    const naturalFlowsFile = document.getElementById('naturalFlows').files[0];
   
    // Output the selected data-values
    // document.write(nodenames+"\n"+nodevalues)



    Swal.fire({
      icon: "info",
      title: "Downloading...",
      text: "Download will start as soon as the case file has been generated by the server!",
      footer: '',
      confirmButtonText:"Acknowledge",
    });
    console.log(naturalFlowsFile)
    senddata(nodenames,nodevalues,naturalFlowsFile)
    
});



function senddata(val1,val2,file){

const string1 = val1;
const string2 = val2;
const serverURL = "/api/generate_excel"; // Replace with your server's URL
const data = {
  string1: string1,
  string2: string2,
};

const formData = new FormData();
formData.append('naturalFlows', file);
// formData.append('data',JSON.stringify(data))
formData.append('string1', string1);  // Assuming nodenames is the correct variable
formData.append('string2', string2) 

const requestOptions = {
  method: 'POST',
  
  body: formData //JSON.stringify(data)
};
console.trace(formData.get('file'))
fetch(serverURL, requestOptions)
  .then(response => {
    if (response.ok) {
      return response.blob();
    } else {
      throw new Error('Failed to generate the Excel file');
    }
  })
  .then(blob => {
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'output.xlsx';
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
  })
  .catch(error => {
    console.error('Error:', error);
  });

}